<!DOCTYPE html>
<html>
<div id="info">HW3</div>
<script src="https://threejs.org/build/three.min.js"></script>
<script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>

<script src="Light.js"></script> 
<head>	
<title>
</title>
<style>
	#info {
		position: absolute;
		top: 0px;
		width: 100%;
		padding: 10px;
		text-align: center;
		color: #ffff00
	}

	body {
		overflow: hidden;
	}

</style>
</head>
<body>
<script>
	var camera, scene, renderer;
	var walls = new THREE.Group(), chairs = new THREE.Group();
	var lightset = new Light();

	init();
	animate();

	function init() {

		scene = new THREE.Scene();
			
		renderer = new THREE.WebGLRenderer();
		renderer.setSize(window.innerWidth, window.innerHeight);
		renderer.setClearColor(0x888888);
		document.body.appendChild(renderer.domElement);

		camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 10000);
		camera.position.set(0, 1000, 800) ; // camera at (0,0,500)
		let controls = new THREE.OrbitControls(camera, renderer.domElement);

		////////////////////////////////////////////////////////
		const light = new THREE.AmbientLight( 0xdddddd );	//環境光 
		scene.add( light, lightset.tipe);
		
		
		let floortex = new THREE.TextureLoader().load("https://i.imgur.com/GKFqbue.jpg");
		floortex.wrapS = THREE.RepeatWrapping;
		floortex.wrapT = THREE.RepeatWrapping;
		floortex.repeat.set(6, 9);
		let floormat = new THREE.MeshLambertMaterial({
			map : floortex,
			side : THREE.DoubleSide
		});
		let floor = new THREE.Mesh(new THREE.PlaneGeometry(1000, 1000), floormat);
		floor.rotation.x = Math.PI/2;
		floor.position.y = -0.1;
		
		
		
		//walls
		//1
		buildWall(1000, 20);
		walls.children[0].position.set(-490, 75, 0);
		walls.children[0].rotation.z = Math.PI/2;
		//1.2
		buildWall(1000, 20);
		walls.children[1].position.set(0, 75, -490);
		//1.3
		buildWall(1000, 20);
		walls.children[2].position.set(490, 75, 0);
		walls.children[2].rotation.z = Math.PI/2;
		//2
		buildWall(350, 20);
		walls.children[3].position.set(-325, 75, 490);
		//2.2
		buildWall(350, 20);
		walls.children[4].position.set(325, 75, 490);
		//3
		let wall3 = new THREE.Mesh(new THREE.BoxGeometry(180, 100, 5), new THREE.MeshLambertMaterial({color : 0xffffff}));
		walls.add(wall3);
		wall3.position.set(0, 50, 257.5);
		//wall3.
		//4
		buildWall(200, 20);
		walls.children[6].position.set(-160, 75, 160);
		walls.children[6].rotation.z = Math.PI/2;
		//4.2
		buildWall(200, 20);
		walls.children[7].position.set(160, 75, 160);
		walls.children[7].rotation.z = Math.PI/2;
		//5
		buildWall(300, 60);
		walls.children[8].position.set(310, 75, 200);
		walls.children[8].rotation.z = Math.PI/2;
		//6
		buildWall(370, 20);
		walls.children[9].position.set(205, 75, -30);
		//7
		buildWall(370, 20);
		walls.children[10].position.set(30, 75, -205);
		walls.children[10].rotation.z = Math.PI/2;
		//8
		buildWall(200, 20);
		walls.children[11].position.set(-290, 75, -380);
		walls.children[11].rotation.z = Math.PI/2;
		//8.2
		buildWall(200, 20);
		walls.children[12].position.set(-290, 75, 20);
		walls.children[12].rotation.z = Math.PI/2;
		//8.3
		buildWall(200, 20);
		walls.children[13].position.set(-390, 75, 110);
		//9
		let wall9 = new THREE.Mesh(new THREE.BoxGeometry(10, 100, 150), new THREE.MeshLambertMaterial({color : 0xffffff}));
		walls.add(wall9);
		wall9.position.set(-392.5, 50, -285);
		//9.2
		let w9 = wall9.clone();
		walls.add(w9);
		w9.position.set(-392.5, 50, -105);
		
		
		//chairs
		//1
		buildChair(60, 120);
		chairs.children[0].position.set(-330, 0, 280);
		//2
		buildChair(90, 90);
		chairs.children[1].position.set(0, 0, 90);
		//3
		buildChair(90, 200);
		chairs.children[2].position.set(-130, 0, -150);
		//4
		buildChair(200, 120);
		chairs.children[3].position.set(250, 0, -260);
		
		scene.add (floor, chairs, walls);
	}
	
	function buildWall(l, w, h){
		let wall = new THREE.Mesh(new THREE.BoxGeometry(l, w, 150), new THREE.MeshLambertMaterial({color : 0xffffff}));
		wall.rotation.x = Math.PI/2;
		walls.add(wall);
	}
	
	function buildChair(l, w) {
		var group = new THREE.Group();
		var leatherTex = new THREE.TextureLoader().load("https://i.imgur.com/vTwbcKR.png");
		var mat = new THREE.MeshLambertMaterial({
			map: leatherTex
		});
		var boxTop = new THREE.Mesh(new THREE.BoxGeometry(l, 15, w), mat);
		
		var boxLeg1 = new THREE.Mesh(new THREE.BoxGeometry(5, 10, 5), new THREE.MeshLambertMaterial({color:'black'}));
		var boxLeg2 = boxLeg1.clone();
		var boxLeg3 = boxLeg1.clone();
		var boxLeg4 = boxLeg1.clone();
		boxTop.position.set(0, 17.5, 0);
		boxLeg1.position.set(-l/2+5, 5, -w/2+5);
		boxLeg2.position.set(-l/2+5, 5, w/2-5);
		boxLeg3.position.set(l/2-5, 5, -w/2+5);
		boxLeg4.position.set(l/2-5, 5, w/2-5);
		
		group.add(boxTop, boxLeg1, boxLeg2, boxLeg3, boxLeg4);
		chairs.add(group);
	}

	function animate() {

		requestAnimationFrame(animate);
		renderer.render(scene, camera);

	}
</script>
</body>
</html>
